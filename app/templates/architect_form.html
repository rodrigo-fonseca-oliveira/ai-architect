<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Architect UI</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 2rem; }
      .card { max-width: 800px; padding: 1.5rem; border: 1px solid #ddd; border-radius: 8px; }
      label { display: block; margin-top: 1rem; font-weight: 600; }
      textarea { width: 100%; height: 120px; }
      select, input[type="checkbox"] { margin-top: .5rem; }
      button { margin-top: 1rem; padding: .6rem 1rem; }
      .flag { color: #666; font-size: .9rem; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Architect</h1>
      {% if not project_guide_enabled %}
        <p class="flag">Note: PROJECT_GUIDE_ENABLED is not set. The API endpoint will return 404 until you export PROJECT_GUIDE_ENABLED=true.</p>
      {% endif %}
      <form method="post" action="/architect/ui">
        <label>Question</label>
        <textarea name="question" placeholder="E.g., How does the router work? or Adapt this for internal policy review."></textarea>

        <label>Mode</label>
        <select name="mode" id="mode" onchange="toggleGrounded()">
          {% for m in modes %}
            <option value="{{m}}">{{m}}</option>
          {% endfor %}
        </select>

        <div id="groundedRow">
          <label>Grounded (citations)</label>
          <input type="checkbox" name="grounded" checked disabled />
          <div class="flag">Guide mode forces grounded with citations.</div>
        </div>

        <button type="submit">Ask</button>
      </form>
    </div>

    <script>
      function toggleGrounded() {
        const mode = document.getElementById('mode').value;
        const row = document.getElementById('groundedRow');
        if (mode === 'brainstorm') {
          row.innerHTML = `
            <label>Grounded (citations)</label>
            <input type="checkbox" name="grounded" />
            <div class="flag">Optional in brainstorm mode.</div>
          `;
        } else {
          row.innerHTML = `
            <label>Grounded (citations)</label>
            <input type="checkbox" name="grounded" checked disabled />
            <div class="flag">Guide mode forces grounded with citations.</div>
          `;
        }
      }
    </script>
  </body>
</html>
